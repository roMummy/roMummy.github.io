<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>APPå¯åŠ¨ä¼˜åŒ–</title>
    <url>/2019/04/09/APP%E5%90%AF%E5%8A%A8%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<h3 id="APPå¯åŠ¨"><a href="#APPå¯åŠ¨" class="headerlink" title="APPå¯åŠ¨"></a>APPå¯åŠ¨</h3><blockquote>
<p>å†·å¯åŠ¨ï¼šApp ç‚¹å‡»å¯åŠ¨å‰ï¼Œå®ƒçš„è¿›ç¨‹ä¸åœ¨ç³»ç»Ÿé‡Œï¼Œéœ€è¦ç³»ç»Ÿæ–°åˆ›å»ºä¸€ä¸ªè¿›ç¨‹ï¼Œéœ€è¦ç³»ç»Ÿæ–°åˆ›å»ºä¸€ä¸ªè¿›ç¨‹åˆ†é…ç»™ä»–ã€‚ä¸€æ¬¡å®Œæ•´çš„å¯åŠ¨è¿‡ç¨‹ï¼›</p>
<p>çƒ­å¯åŠ¨ï¼šappåœ¨åå°ï¼Œè¿›ç¨‹è¿˜åœ¨ç³»ç»Ÿä¸­ã€‚</p>
</blockquote>
<hr>
<h3 id="å†·å¯åŠ¨ä¼˜åŒ–"><a href="#å†·å¯åŠ¨ä¼˜åŒ–" class="headerlink" title="å†·å¯åŠ¨ä¼˜åŒ–"></a>å†·å¯åŠ¨ä¼˜åŒ–</h3><p>appå¯åŠ¨3é˜¶æ®µï¼š</p>
<blockquote>
<ol>
<li>main()å‡½æ•°æ‰§è¡Œå‰ï¼›</li>
<li>main()å‡½æ•°æ‰§è¡Œåï¼›</li>
<li>é¦–å±æ¸²æŸ“å®Œæˆåã€‚</li>
</ol>
</blockquote>
<h4 id="main-å‡½æ•°æ‰§è¡Œå‰"><a href="#main-å‡½æ•°æ‰§è¡Œå‰" class="headerlink" title="main()å‡½æ•°æ‰§è¡Œå‰"></a>main()å‡½æ•°æ‰§è¡Œå‰</h4><p>ç³»ç»Ÿæ“ä½œï¼š</p>
<ul>
<li><p>åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆ.0æ–‡ä»¶ï¼‰ï¼ŒåŠ¨æ€è¿æ¥å™¨é¦–å…ˆä¼šæ£€æŸ¥å…±äº«ç¼“å­˜çœ‹çœ‹æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±ç›´æ¥ä»å…±äº«ç¼“å­˜ä¸­æ‹¿å‡ºæ¥ä½¿ç”¨ã€‚æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æŠŠè¿™ä¸ªå…±äº«ç¼“å­˜æ˜ å°„åˆ°è‡ªå·±çš„åœ°å€ç©ºé—´ä¸­ã€‚</p>
</li>
<li><p>åŠ è½½åŠ¨æ€é“¾æ¥åº“ï¼Œè¿›è¡ŒrebaseæŒ‡é’ˆè°ƒæ•´å’Œbindç¬¦å·ç»‘å®š</p>
<blockquote>
<p>åŠ¨æ€åº¦çš„åŠ è½½è¿‡ç¨‹ï¼š</p>
<p>â‘ åˆ†ææ‰€ä¾èµ–çš„åŠ¨æ€åº“<br>â‘¡æ‰¾åˆ°åŠ¨æ€åº“çš„mach-oæ–‡ä»¶<br>â‘¢æ‰“å¼€æ–‡ä»¶<br>â‘£éªŒè¯æ–‡ä»¶<br>â‘¤åœ¨ç³»ç»Ÿæ ¸å¿ƒæ³¨å†Œæ–‡ä»¶ç­¾å<br>â‘¥å¯¹åŠ¨æ€åº“çš„æ¯ä¸€ä¸ªsegmentè°ƒç”¨mmap()</p>
</blockquote>
</li>
<li><p>Objcè¿è¡Œæ—¶åˆå§‹å¤„ç†ï¼ˆç›¸å…³ç±»æ³¨å†Œã€categoryæ³¨å†Œã€selectorå”¯ä¸€æ€§æ£€æŸ¥ï¼‰</p>
</li>
<li><p>åˆå§‹åŒ–ï¼Œæ‰§è¡Œ+load()æ–¹æ³•ã€attributeä¿®é¥°çš„å‡½æ•°çš„è°ƒç”¨ã€åˆ›å»ºc++é™æ€å…¨å±€å˜é‡</p>
</li>
</ul>
<p>ä¼˜åŒ–ï¼š</p>
<ul>
<li>å‡å°‘åŠ¨æ€åº“åŠ è½½ï¼Œå°½é‡å°†å¤šä¸ªåŠ¨æ€åº“åˆå¹¶</li>
<li>å‡å°‘åŠ è½½å¯åŠ¨åä¸ä¼šå»ä½¿ç”¨çš„ç±»æˆ–è€…æ–¹æ³•</li>
<li>å‡å°‘ä½¿ç”¨+load()æ–¹æ³•ï¼Œä½¿ç”¨+initialize()æ–¹æ³•æ›¿æ¢ã€‚åœ¨ä¸€ä¸ª +load() æ–¹æ³•é‡Œï¼Œè¿›è¡Œè¿è¡Œæ—¶æ–¹æ³•æ›¿æ¢æ“ä½œä¼šå¸¦æ¥4æ¯«ç§’çš„æ¶ˆè€—</li>
<li>æ§åˆ¶c++å…¨å±€å˜é‡çš„æ•°é‡</li>
</ul>
<blockquote>
<p>é€šè¿‡åœ¨å·¥ç¨‹çš„schemeä¸­æ·»åŠ ç¯å¢ƒå˜é‡<code>DYLD_PRINT_STATISTICS</code>ï¼Œè®¾ç½®å€¼ä¸º1ï¼ŒAppå¯åŠ¨åŠ è½½æ—¶Xcodeçš„æ§åˆ¶å°å°±ä¼šæœ‰pre-mainå„ä¸ªé˜¶æ®µçš„è¯¦ç»†è€—æ—¶è¾“å‡ºã€‚ä½†æ˜¯<code>DYLD_PRINT_STATISTICS</code>å˜é‡æ‰“å°æ—¶é—´æ˜¯iOS10ä»¥åæ‰æ”¯æŒçš„åŠŸèƒ½ï¼Œæ‰€ä»¥éœ€è¦ç”¨iOS10ç³»ç»ŸåŠä»¥ä¸Šçš„æœºå™¨æ¥åšæµ‹è¯•ã€‚</p>
</blockquote>
<h4 id="mian-å‡½æ•°æ‰§è¡Œ"><a href="#mian-å‡½æ•°æ‰§è¡Œ" class="headerlink" title="mian()å‡½æ•°æ‰§è¡Œ"></a>mian()å‡½æ•°æ‰§è¡Œ</h4><p><img src="http://www.zoomfeng.com/images/2018/07/5.png" alt="img"></p>
<h4 id="mian-å‡½æ•°æ‰§è¡Œå"><a href="#mian-å‡½æ•°æ‰§è¡Œå" class="headerlink" title="mian()å‡½æ•°æ‰§è¡Œå"></a>mian()å‡½æ•°æ‰§è¡Œå</h4><p>mian()å‡½æ•°æ‰§è¡Œâ€“&gt;didFinishLaunchingWithOptions æ–¹æ³•é‡Œé¦–å±æ¸²æŸ“ç›¸å…³æ–¹æ³•æ‰§è¡Œå®Œæˆ</p>
<p>æ‰§è¡Œï¼š</p>
<blockquote>
<ul>
<li>é¦–å±åˆå§‹åŒ–æ‰€éœ€é…ç½®æ–‡ä»¶çš„è¯»å†™æ“ä½œ</li>
<li>é¦–å±æ•°æ®è¯»å–</li>
<li>é¦–å±æ¸²æŸ“çš„å¤§é‡è®¡ç®—</li>
</ul>
</blockquote>
<p>ä¼˜åŒ–ï¼š</p>
<blockquote>
<p>didFinishLaunchingWithOptionsæ–¹æ³•é‡Œé¢åˆ¶ä½œå¿…è¦çš„æ“ä½œã€‚å…¶å®ƒçš„æ“ä½œæ”¾åˆ°å¯¹åº”çš„åŠŸèƒ½å»åˆå§‹åŒ–</p>
</blockquote>
<h4 id="é¦–å±æ¸²æŸ“å®Œæˆå"><a href="#é¦–å±æ¸²æŸ“å®Œæˆå" class="headerlink" title="é¦–å±æ¸²æŸ“å®Œæˆå"></a>é¦–å±æ¸²æŸ“å®Œæˆå</h4><p>é¦–å±æ¸²æŸ“å®Œæˆâ€“&gt;didFinishLaunchingWithOptionsæ–¹æ³•ç»“æŸ</p>
<p>æ‰§è¡Œï¼š</p>
<blockquote>
<p>éé¦–å±å…¶å®ƒä¸šåŠ¡æ¨¡å—çš„åˆå§‹åŒ–ã€ç›‘å¬çš„æ³¨å†Œã€é…ç½®æ–‡ä»¶çš„è¯»å–ç­‰</p>
</blockquote>
<h4 id="åŠŸèƒ½çº§åˆ«çš„å¯åŠ¨ä¼˜åŒ–"><a href="#åŠŸèƒ½çº§åˆ«çš„å¯åŠ¨ä¼˜åŒ–" class="headerlink" title="åŠŸèƒ½çº§åˆ«çš„å¯åŠ¨ä¼˜åŒ–"></a>åŠŸèƒ½çº§åˆ«çš„å¯åŠ¨ä¼˜åŒ–</h4><p><img src="https://static001.geekbang.org/resource/image/f3/19/f30f438d447e81132dd520e657427419.png" alt="img"></p>
<h4 id="æ–¹æ³•çº§åˆ«çš„å¯åŠ¨ä¼˜åŒ–"><a href="#æ–¹æ³•çº§åˆ«çš„å¯åŠ¨ä¼˜åŒ–" class="headerlink" title="æ–¹æ³•çº§åˆ«çš„å¯åŠ¨ä¼˜åŒ–"></a>æ–¹æ³•çº§åˆ«çš„å¯åŠ¨ä¼˜åŒ–</h4><p>objc_msgSend ï¼šåœ¨è¿è¡Œæ—¶æ ¹æ®å¯¹è±¡å’Œæ–¹æ³•çš„selectorå»æ‰¾åˆ°å¯¹åº”çš„å‡½æ•°æŒ‡é’ˆï¼Œç„¶åæ‰§è¡Œã€‚èƒ½å¤Ÿæ§åˆ¶æ‰€æœ‰çš„ocæ–¹æ³•ã€‚</p>
<p><a href="https://opensource.apple.com/source/objc4/objc4-723/runtime/Messengers.subproj/">æºç </a></p>
<blockquote>
<p>objc_msgSendé€»è¾‘ï¼šå…ˆè·å–å¯¹è±¡å¯¹åº”ç±»çš„ä¿¡æ¯ï¼Œå†è·å–æ–¹æ³•çš„ç¼“å­˜ï¼Œæ ¹æ®æ–¹æ³•çš„selectoræŸ¥æ‰¾å‡½æ•°æŒ‡é’ˆï¼Œç»è¿‡å¼‚å¸¸é”™è¯¯å¤„ç†åï¼Œæœ€åè·³åˆ°å¯¹åº”å‡½æ•°çš„å®ç°ã€‚</p>
</blockquote>
<p>èµ„æ–™ï¼š</p>
<blockquote>
<p><a href="https://time.geekbang.org/column/article/85331?code=0eTznNzpAbVisw%252525252FesJ9iM32u2ctcY8OqwgMuqSlv5OE%252525253D">æ¥æº</a></p>
<p><a href="http://www.zoomfeng.com/blog/launch-time.html">iOSå¯åŠ¨æ—¶é—´ä¼˜åŒ–</a></p>
<p><a href="http://www.ruanyifeng.com/blog/2018/01/assembly-language-primer.html">æ±‡ç¼–</a></p>
</blockquote>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>CentOSä¸Šå®‰è£…redis</title>
    <url>/2018/07/13/CentOS%E4%B8%8A%E5%AE%89%E8%A3%85redis/</url>
    <content><![CDATA[<h3 id="ç›®çš„"><a href="#ç›®çš„" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h3><p>ä¸ºäº†ç»ƒä¹ åœ¨springbootä¸­ä½¿ç”¨redisæ•°æ®åº“ï¼Œæœ¬äººæ¯”è¾ƒæ‡’ ä¸æƒ³æŠŠredisæ•°æ®åº“è£…åœ¨æœ¬åœ°ï¼Œæ­£å¥½æœ‰ä¸€ä¸ªå…è´¹çš„æœåŠ¡å™¨å¯ä»¥ç© ã€‚ äºæ˜¯åœ¨linuxä¸Šå®‰è£…redisï¼Œä¸‹é¢æ˜¯å®‰è£…redisé‡åˆ°çš„å‘ã€‚</p>
<h2 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h2><blockquote>
<p>ç³»ç»Ÿ: CentOS Linux release 7.4.1708 (Core) </br><br>redisç‰ˆæœ¬: redis-4.0.10 </br><br>rediså®˜ç½‘: <a href="http://www.redis.cn/download.html">http://www.redis.cn/download.html</a></p>
</blockquote>
<p>ç¬¬ä¸€æ­¥å½“ç„¶æ˜¯æŒ‰ç…§å®˜æ–¹çš„æ­¥éª¤ä¸€æ­¥ä¸€æ­¥æ¥ç€ã€‚</p>
<blockquote>
<p>$ wget <a href="http://download.redis.io/releases/redis-4.0.10.tar.gz">http://download.redis.io/releases/redis-4.0.10.tar.gz</a> </br><br>$ tar xzf redis-4.0.10.tar.gz <br><br>$ cd redis-4.0.10 <br><br>$ make</p>
</blockquote>
<p>å—¯å—¯ ä¸€æ°”å‘µæˆã€‚æ²¡å•¥å‘å˜› å“ˆå“ˆ æƒ³å¤šäº†</p>
<blockquote>
<p>make[3]: gccï¼šå‘½ä»¤æœªæ‰¾åˆ°</p>
</blockquote>
<p>æ©æ©é¢ å¥½å§ å®‰è£…gcc</p>
<blockquote>
<p>yum -y install gcc automake autoconf libtool make</p>
</blockquote>
<p>â€¦â€¦â€¦â€¦â€¦â€¦â€¦..<br><br>è¿›è¿‡ä¸€æ®µæ—¶é—´çš„ç­‰å¾… ç»ˆäºæå®šgccäº†ï¼ ç»§ç»­make</p>
<blockquote>
<p>zmalloc.h:50:31: è‡´å‘½é”™è¯¯ï¼šjemalloc&#x2F;jemalloc.hï¼šæ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•<br> #include &lt;jemalloc&#x2F;jemalloc.h&gt;</p>
</blockquote>
<p> WTFï¼Ÿï¼Ÿ<br> é©¬ä¸¹ è¿™æ˜¯ä»€ä¹ˆğŸ‘» äºŒè¯ä¸è¯´ï¼Œç™¾åº¦<br> è§£å†³æ–¹æ³•ï¼š</p>
<blockquote>
<p>make MALLOC&#x3D;libc</p>
</blockquote>
<p> è¿™æ˜¯å•¥ï¼Ÿä¸ºå•¥è¦è¿™ä¹ˆåšï¼Ÿç½‘ä¸Šæ²¡æ‰¾åˆ°ç­”æ¡ˆ é—®äº†å¤§ä½¬æ‰çŸ¥é“MALLOC&#x3D;libcæ˜¯ </p>
<ul>
<li>ç¼–è¯‘å¹¶æŒ‡å®šåŠ¨æ€å†…å­˜åˆ†é…åŠŸèƒ½ä½¿ç”¨libcæä¾›çš„</li>
</ul>
<p> åŸæ¥æ˜¯å†…å­˜åˆ†é…çš„å•Š ä¸ºå•¥redisè¦ç”¨è¿™ä¸ªåŠŸèƒ½å‘¢ æ¥çœ‹çœ‹redisçš„åŸç†ï¼š</p>
<blockquote>
<p>Redisæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªKey-Valueç±»å‹çš„å†…å­˜æ•°æ®åº“ï¼Œå¾ˆåƒmemcachedï¼Œæ•´ä¸ªæ•°æ®åº“ç»Ÿç»ŸåŠ è½½åœ¨å†…å­˜å½“ä¸­è¿›è¡Œæ“ä½œï¼Œå®šæœŸé€šè¿‡å¼‚æ­¥æ“ä½œæŠŠæ•°æ®åº“æ•°æ®flushåˆ°ç¡¬ç›˜ä¸Šè¿›è¡Œä¿å­˜ã€‚å› ä¸ºæ˜¯çº¯å†…å­˜æ“ä½œï¼ŒRedisçš„æ€§èƒ½éå¸¸å‡ºè‰²ï¼Œæ¯ç§’å¯ä»¥å¤„ç†è¶…è¿‡ 10ä¸‡æ¬¡è¯»å†™æ“ä½œï¼Œæ˜¯å·²çŸ¥æ€§èƒ½æœ€å¿«çš„Key-Value DBã€‚<br>Redisçš„å‡ºè‰²ä¹‹å¤„ä¸ä»…ä»…æ˜¯æ€§èƒ½ï¼ŒRedisæœ€å¤§çš„é­…åŠ›æ˜¯æ”¯æŒä¿å­˜å¤šç§æ•°æ®ç»“æ„ï¼Œæ­¤å¤–å•ä¸ªvalueçš„æœ€å¤§é™åˆ¶æ˜¯1GBï¼Œä¸åƒ memcachedåªèƒ½ä¿å­˜1MBçš„æ•°æ®ï¼Œå› æ­¤Rediså¯ä»¥ç”¨æ¥å®ç°å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œæ¯”æ–¹è¯´ç”¨ä»–çš„Listæ¥åšFIFOåŒå‘é“¾è¡¨ï¼Œå®ç°ä¸€ä¸ªè½»é‡çº§çš„é«˜æ€§ èƒ½æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡ï¼Œç”¨ä»–çš„Setå¯ä»¥åšé«˜æ€§èƒ½çš„tagç³»ç»Ÿç­‰ç­‰ã€‚å¦å¤–Redisä¹Ÿå¯ä»¥å¯¹å­˜å…¥çš„Key-Valueè®¾ç½®expireæ—¶é—´ï¼Œå› æ­¤ä¹Ÿå¯ä»¥è¢«å½“ä½œä¸€ ä¸ªåŠŸèƒ½åŠ å¼ºç‰ˆçš„memcachedæ¥ç”¨ã€‚<br>Redisçš„ä¸»è¦ç¼ºç‚¹æ˜¯æ•°æ®åº“å®¹é‡å—åˆ°ç‰©ç†å†…å­˜çš„é™åˆ¶ï¼Œä¸èƒ½ç”¨ä½œæµ·é‡æ•°æ®çš„é«˜æ€§èƒ½è¯»å†™ï¼Œå› æ­¤Redisé€‚åˆçš„åœºæ™¯ä¸»è¦å±€é™åœ¨è¾ƒå°æ•°æ®é‡çš„é«˜æ€§èƒ½æ“ä½œå’Œè¿ç®—ä¸Š</p>
</blockquote>
<p>æ©æ©é¢ åŸæ¥redisç»å¸¸å’Œå†…å­˜æ‰“äº¤é“å•Š å†æ¥çœ‹çœ‹jemallocå¹²å˜›ç”¨çš„ï¼š</p>
<blockquote>
<p>jemallocæ˜¯ä¸€ä¸ªé€šç”¨çš„mallocï¼ˆ3ï¼‰å®ç°ï¼Œå®ƒå¼ºè°ƒäº†<br>ç¢ç‰‡é¿å…å’Œå¯æ‰©å±•çš„å¹¶å‘æ”¯æŒã€‚jemalloc<br>äº2005å¹´é¦–æ¬¡ä½œä¸ºFreeBSD libcåˆ†é…å™¨ä½¿ç”¨ï¼Œä»é‚£ä»¥åå®ƒå·²ç»<br>è¿›å…¥è®¸å¤šä¾èµ–äºå…¶å¯é¢„æµ‹è¡Œä¸ºçš„åº”ç”¨ç¨‹åºã€‚2010å¹´ï¼Œ<br>jemallocå¼€å‘å·¥ä½œèŒƒå›´æ‰©å¤§åˆ°åŒ…æ‹¬å¼€å‘äººå‘˜æ”¯æŒåŠŸèƒ½<br>ï¼Œå¦‚å †åˆ†æå’Œå¹¿æ³›çš„ç›‘æ§&#x2F;è°ƒä¼˜é’©å­ã€‚ç°ä»£jemalloc<br>ç‰ˆæœ¬ç»§ç»­è¢«é›†æˆåˆ°FreeBSDä¸­ï¼Œå› æ­¤å¤šåŠŸèƒ½æ€§<br>ä»ç„¶è‡³å…³é‡è¦ã€‚æ­£åœ¨è¿›è¡Œçš„å¼€å‘å·¥ä½œè¶‹åŠ¿æ˜¯å°†jemalloc<br>ä½œä¸ºå¹¿æ³›çš„è‹›åˆ»åº”ç”¨çš„æœ€ä½³åˆ†é…å™¨ä¹‹ä¸€ï¼Œå¹¶ä¸”<br>æ¶ˆé™¤&#x2F;å‡è½»å¯¹ç°å®<br>ä¸–ç•Œåº”ç”¨äº§ç”Ÿå®é™…å½±å“çš„å¼±ç‚¹ã€‚</p>
</blockquote>
<p>ä¸ªäººç†è§£çš„æ˜¯</p>
<blockquote>
<p>redisä¸»è¦æ˜¯åœ¨å†…å­˜ä¸Šæ“ä½œ è€Œåœ¨å†…å­˜ä¸Šæ“ä½œå°±ä¸å¯é¿å…çš„ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡  ä¸ºäº†ä¼˜åŒ–å†…å­˜ç¢ç‰‡æ‰é€‰æ‹©çš„æ˜¯jemalloc</p>
</blockquote>
<p>å¥½ å®‰è£…jemalloc</p>
<h4 id="å®‰è£…jemalloc"><a href="#å®‰è£…jemalloc" class="headerlink" title="å®‰è£…jemalloc"></a>å®‰è£…jemalloc</h4><blockquote>
<p>#ä¸‹è½½ <br><br> wget <a href="https://github.com/jemalloc/jemalloc/releases/download/4.2.1/jemalloc-4.2.1.tar.bz2">https://github.com/jemalloc/jemalloc/releases/download/4.2.1/jemalloc-4.2.1.tar.bz2</a>  <br><br>#è§£å‹ <br><br>tar -xjvf jemalloc-4.2.1.tar.bz2 <br><br>#åœ¨jemalloc-4.2.1ç›®å½•ä¸‹é¢„ç¼–è¯‘<br><br>.&#x2F;configure â€“prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;jemalloc<br><br>#ç¼–è¯‘<br><br>make -j8 &amp;&amp; make install</p>
</blockquote>
<p>å®Œæˆ ä½†æ˜¯ä¸æ™“å¾—ä¸ºå•¥è¿è¡Œè¿˜æ˜¯æœ‰é‚£ä¸ªé”™è¯¯ æˆ‘æ˜¯linuxå°ç™½ã€‚ã€‚ã€‚</p>
<hr>
<h4 id="ç›´æ¥å®‰è£…jemallocä¾èµ–"><a href="#ç›´æ¥å®‰è£…jemallocä¾èµ–" class="headerlink" title="ç›´æ¥å®‰è£…jemallocä¾èµ–"></a>ç›´æ¥å®‰è£…jemallocä¾èµ–</h4><p>githubä¸Šçš„issuesæ—©å°±å‘Šè¯‰äº†æˆ‘ä»¬ç­”æ¡ˆ</p>
<ul>
<li><a href="https://github.com/antirez/redis/issues/722">https://github.com/antirez/redis/issues/722</a></li>
</ul>
<p>åœ¨redisç›®å½•ä¸‹è¿›å…¥ </p>
<blockquote>
<p>cd deps</p>
</blockquote>
<p>å®‰è£…jemallocä¾èµ–</p>
<blockquote>
<p>make hiredis lua jemalloc linenoise</p>
</blockquote>
<blockquote>
<p>cd ..&#x2F;</p>
</blockquote>
<p>é‡æ–°ç¼–è¯‘</p>
<blockquote>
<p>make</p>
</blockquote>
<p>æˆåŠŸ</p>
<h3 id="å¯åŠ¨redis"><a href="#å¯åŠ¨redis" class="headerlink" title="å¯åŠ¨redis"></a>å¯åŠ¨redis</h3><blockquote>
<p>src&#x2F;redis-server</p>
</blockquote>
<p>åŠ è½½é…ç½® é…ç½®æ–‡ä»¶åœ¨åˆšåˆšå®‰è£…redisæ–‡ä»¶å¤¹ä¸‹ </p>
<blockquote>
<p>src&#x2F;redis-server .&#x2F;redis.conf </p>
</blockquote>
<p>åœæ­¢redis</p>
<blockquote>
<p>src&#x2F;redis-cli shutdown</p>
</blockquote>
<p>å¯åŠ¨rediså®¢æˆ·ç«¯</p>
<blockquote>
<p>src&#x2F;redis-cli</p>
</blockquote>
<p>å¦‚æœè¢«å¡ä½äº†å°±ä½¿ç”¨killç›´æ¥æ€æ­»</p>
<blockquote>
<p>kill -9 è¿›ç¨‹å·</p>
</blockquote>
<p>ä½¿ç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤æŸ¥æ‰¾è¿›ç¨‹å·</p>
<blockquote>
<p>ps -ef|grep redis</p>
</blockquote>
<h3 id="é…ç½®redis"><a href="#é…ç½®redis" class="headerlink" title="é…ç½®redis"></a>é…ç½®redis</h3><ul>
<li><p>ç¬¬ä¸€æ­¥ï¼šè¿›å…¥redisç›®å½•</p>
<blockquote>
<p>cd redis-4.0.10&#x2F;</p>
</blockquote>
</li>
<li><p>ç¬¬äºŒéƒ¨ï¼šæ‰“å¼€é…ç½®æ–‡ä»¶</p>
<blockquote>
<p>vim redis.conf</p>
</blockquote>
</li>
<li><p>ç¬¬ä¸‰éƒ¨ï¼šæ³¨é‡Šæ‰ç¯å†…åœ°å€</p>
<blockquote>
<p>#bind 127.0.0.1</p>
</blockquote>
</li>
<li><p>ç¬¬å››éƒ¨ï¼šé…ç½®å¯†ç </p>
<blockquote>
<p>requirepass â€œ123456â€</p>
</blockquote>
</li>
<li><p>ç¬¬äº”æ­¥ï¼šä¿å­˜é€€å‡º</p>
<blockquote>
<p>wq</p>
</blockquote>
</li>
<li><p>ç¬¬å…­æ­¥ï¼šé‡å¯redis</p>
<blockquote>
<p>ps -ef|grep redis(æŸ¥æ‰¾è¿›ç¨‹å·)<br><br>kill -9 xxxx(è¿›ç¨‹å·)<br><br>src&#x2F;redis-server .&#x2F;redis.conf(ä½¿ç”¨é…ç½®å¯åŠ¨)</p>
</blockquote>
</li>
</ul>
<p>OVER</p>
<h3 id="æµ‹è¯•è¿æ¥redisï¼ˆspringbootï¼‰"><a href="#æµ‹è¯•è¿æ¥redisï¼ˆspringbootï¼‰" class="headerlink" title="æµ‹è¯•è¿æ¥redisï¼ˆspringbootï¼‰"></a>æµ‹è¯•è¿æ¥redisï¼ˆspringbootï¼‰</h3><p>é…ç½®ä¿¡æ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># REDIS (RedisProperties)</span><br><span class="line"># Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä¸º0ï¼‰</span><br><span class="line">spring.redis.database=0</span><br><span class="line"># RedisæœåŠ¡å™¨åœ°å€</span><br><span class="line">spring.redis.host=localhost</span><br><span class="line"># RedisæœåŠ¡å™¨è¿æ¥ç«¯å£</span><br><span class="line">spring.redis.port=6379</span><br><span class="line"># RedisæœåŠ¡å™¨è¿æ¥å¯†ç ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰</span><br><span class="line">spring.redis.password=</span><br><span class="line"># è¿æ¥æ± æœ€å¤§è¿æ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰</span><br><span class="line">spring.redis.pool.max-active=8</span><br><span class="line"># è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰</span><br><span class="line">spring.redis.pool.max-wait=-1</span><br><span class="line"># è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥</span><br><span class="line">spring.redis.pool.max-idle=8</span><br><span class="line"># è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥</span><br><span class="line">spring.redis.pool.min-idle=0</span><br><span class="line"># è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span><br><span class="line">spring.redis.timeout=0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç¼–å†™æµ‹è¯•ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@RunWith(SpringRunner.class)</span><br><span class="line">@SpringBootTest</span><br><span class="line">public class RedisApplicationTests &#123;</span><br><span class="line"></span><br><span class="line">	@Autowired</span><br><span class="line">	private StringRedisTemplate stringRedisTemplate;</span><br><span class="line"></span><br><span class="line">	@Test</span><br><span class="line">	public void contextLoads() &#123;</span><br><span class="line">		stringRedisTemplate.opsForValue().set(&quot;a&quot;,&quot;\n---------å“ˆå“ˆå“ˆå“ˆå“ˆ&quot;);</span><br><span class="line">		System.out.print(stringRedisTemplate.opsForValue().get(&quot;a&quot;));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title>iOS PDFæ·»åŠ æ°´å°</title>
    <url>/2022/07/20/iOS%20PDF%E6%B7%BB%E5%8A%A0%E6%B0%B4%E5%8D%B0/</url>
    <content><![CDATA[<h2 id="iOS-PDFæ·»åŠ æ°´å°"><a href="#iOS-PDFæ·»åŠ æ°´å°" class="headerlink" title="iOS PDFæ·»åŠ æ°´å°"></a>iOS PDFæ·»åŠ æ°´å°</h2><p>æœ€è¿‘åœ¨åšPDFç›¸å…³çš„é¡¹ç›®ï¼Œè®°å½•ä¸€ä¸‹</p>
<h3 id="å®ç°åŠŸèƒ½"><a href="#å®ç°åŠŸèƒ½" class="headerlink" title="å®ç°åŠŸèƒ½"></a>å®ç°åŠŸèƒ½</h3><ul>
<li>æ”¯æŒæ·»åŠ æ–‡å­—æ°´å°</li>
<li>æ”¯æŒæ—‹è½¬</li>
<li>æ”¯æŒå¯¼å‡º</li>
<li>æ”¯æŒé€æ˜åº¦</li>
<li>æ”¯æŒå›¾å±‚</li>
<li>æ”¯æŒå¹³é“º</li>
<li>æ”¯æŒæ·»åŠ é¡µé¢èŒƒå›´</li>
<li>æ”¯æŒå­—ä½“æ ·å¼è®¾ç½®</li>
<li>æ”¯æŒå®æ—¶å˜æ›´</li>
</ul>
<h3 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h3><ul>
<li><p>é€šè¿‡ä½¿ç”¨è‹¹æœè‡ªå¸¦çš„PDFKitæ¥å®ç°ã€‚</p>
<p>PDFDocumentæœ‰ä¸€ä¸ªdelegateï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªä»£ç†æ–¹æ³•<code>func classForPage() -&gt; AnyClass</code>ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥è®©æˆ‘ä»¬è‡ªå·±ç»˜åˆ¶PDFPageã€‚ç»˜åˆ¶å¥½PDFä¹‹åå°±å¯ä»¥ä½¿ç”¨PDFDocumentæä¾›çš„<code>write(toFile path: String) -&gt; Bool</code>æ¥å¯¼å‡ºã€‚</p>
</li>
</ul>
<h3 id="å…·ä½“å®ç°"><a href="#å…·ä½“å®ç°" class="headerlink" title="å…·ä½“å®ç°"></a>å…·ä½“å®ç°</h3><ul>
<li><p>ç»˜åˆ¶æ°´å°</p>
<p>åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„PDFPage</p>
<p>ç„¶åé‡å†™<code>func draw(with box: PDFDisplayBox, to context: CGContext)</code>æ–¹æ³•</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PDFWatermarkPage</span>: <span class="title class_">PDFPage</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> pageIndex: <span class="type">Int</span>? &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> label <span class="operator">=</span> label &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">Int</span>(label)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">draw</span>(<span class="params">with</span> <span class="params">box</span>: <span class="type">PDFDisplayBox</span>, <span class="params">to</span> <span class="params">context</span>: <span class="type">CGContext</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.draw(with: box, to: context)</span><br><span class="line">        <span class="keyword">let</span> config <span class="operator">=</span> <span class="type">PDFWatermarkTool</span>.<span class="type">PageConfiguration</span>.shared.configuration</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> pageIndex <span class="operator">=</span> pageIndex <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> pageIndex <span class="operator">&lt;</span> config.startPageIndex &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> pageIndex <span class="operator">&gt;</span> config.endPageIndex &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="type">UIGraphicsPushContext</span>(context)</span><br><span class="line">        context.saveGState()</span><br><span class="line">        <span class="keyword">let</span> pageBounds <span class="operator">=</span> bounds(for: box)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;page - <span class="subst">\(label)</span>&quot;</span>)</span><br><span class="line">        <span class="comment">// æ¸²æŸ“æ–‡å­—</span></span><br><span class="line">        drawWatermark(config: config,</span><br><span class="line">                      contextWidth: pageBounds.width, </span><br><span class="line">                      contextHeight: pageBounds.height)</span><br><span class="line">        </span><br><span class="line">        context.restoreGState()</span><br><span class="line">        <span class="type">UIGraphicsPopContext</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/// è®¡ç®—æ•´ä¸ªé¡µé¢å¯ä»¥ç»˜åˆ¶å¤šå°‘ä¸ªæ–‡æœ¬ ç„¶åå¾ªç¯ç»˜åˆ¶æ–‡æœ¬</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">drawWatermark</span>(<span class="params">config</span>: <span class="type">PDFWatermarkTool</span>.<span class="type">Configuration</span>,</span><br><span class="line">                       <span class="params">contextWidth</span>: <span class="type">CGFloat</span>,</span><br><span class="line">                       <span class="params">contextHeight</span>: <span class="type">CGFloat</span>) &#123;</span><br><span class="line">        <span class="keyword">guard</span> config.text.count <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ–œçº¿é•¿</span></span><br><span class="line">        <span class="keyword">let</span> sqrtLength <span class="operator">=</span> sqrt(contextWidth <span class="operator">*</span> contextWidth <span class="operator">+</span> contextHeight <span class="operator">*</span> contextHeight)</span><br><span class="line">        <span class="comment">// ç»˜åˆ¶æ–‡å­—çš„å±æ€§</span></span><br><span class="line">        <span class="keyword">let</span> attributes <span class="operator">=</span> [</span><br><span class="line">            <span class="type">NSAttributedString</span>.<span class="type">Key</span>.foregroundColor: config.textColor.withAlphaComponent(config.textAlpha),</span><br><span class="line">            <span class="type">NSAttributedString</span>.<span class="type">Key</span>.font: config.textFont,</span><br><span class="line">        ]</span><br><span class="line">        <span class="keyword">let</span> mAttributesStr <span class="operator">=</span> <span class="type">NSMutableAttributedString</span>(string: config.text, attributes: attributes)</span><br><span class="line">        <span class="comment">// ç»˜åˆ¶æ–‡å­—çš„å®½é«˜</span></span><br><span class="line">        <span class="keyword">let</span> mStrW <span class="operator">=</span> mAttributesStr.size().width</span><br><span class="line">        <span class="keyword">let</span> mStrH <span class="operator">=</span> mAttributesStr.size().height</span><br><span class="line">        <span class="comment">// æ–‡å­—é—´è·</span></span><br><span class="line">        <span class="keyword">let</span> verticalSpace: <span class="type">CGFloat</span> <span class="operator">=</span> config.textVerticalSpace</span><br><span class="line">        <span class="keyword">let</span> horizontalSpace: <span class="type">CGFloat</span> <span class="operator">=</span> config.textHorizontalSpace</span><br><span class="line">                </span><br><span class="line">        <span class="comment">// è·å–ä¸Šä¸‹æ–‡</span></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> context <span class="operator">=</span> <span class="type">UIGraphicsGetCurrentContext</span>() <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä¿å­˜ä¸Šä¸‹æ–‡ï¼Œå‹æ ˆ</span></span><br><span class="line">        context.saveGState()</span><br><span class="line">        <span class="comment">// ç¿»è½¬åæ ‡ç³»ï¼Œåœ†ç‚¹ä»å·¦ä¸‹è§’å˜åŒ–åˆ°å·¦ä¸Šè§’</span></span><br><span class="line">        context.translateBy(x: <span class="number">0</span>, y: contextHeight)</span><br><span class="line">        context.scaleBy(x: <span class="number">1.0</span>, y: <span class="operator">-</span><span class="number">1.0</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç§»åŠ¨ç»˜åˆ¶åœ†ç‚¹åˆ°ç”»å¸ƒä¸­å¿ƒ</span></span><br><span class="line">        context.translateBy(x: contextWidth<span class="operator">/</span><span class="number">2.0</span>, y: contextHeight<span class="operator">/</span><span class="number">2.0</span>)</span><br><span class="line">        <span class="comment">// æ—‹è½¬</span></span><br><span class="line">        <span class="comment">// å¯¼å‡ºçš„æ—¶å€™éœ€è¦ç‰¹æ®Šå¤„ç†æ—‹è½¬è§’åº¦</span></span><br><span class="line">        <span class="keyword">let</span> angle <span class="operator">=</span> config.isExport <span class="operator">?</span> (config.textAngle <span class="operator">-</span> rotation): config.textAngle</span><br><span class="line">        context.rotate(by: <span class="type">CGFloat</span>(angle)<span class="operator">*</span>(<span class="type">CGFloat</span>.pi<span class="operator">/</span><span class="number">180.0</span>))</span><br><span class="line">        <span class="comment">// å°†ç»˜åˆ¶åŸç‚¹æ¢å¤åˆå§‹å€¼ï¼Œä¿è¯å½“å‰contextä¸­å¿ƒå’Œæºimageçš„ä¸­å¿ƒå¤„åœ¨ä¸€ä¸ªç‚¹</span></span><br><span class="line">        <span class="comment">// (å½“å‰contextå·²ç»æ—‹è½¬ï¼Œæ‰€ä»¥ç»˜åˆ¶å‡ºçš„ä»»ä½•layeréƒ½æ˜¯å€¾æ–œçš„)</span></span><br><span class="line">        context.translateBy(x: <span class="operator">-</span>contextWidth<span class="operator">/</span><span class="number">2.0</span>, y: <span class="operator">-</span>contextHeight<span class="operator">/</span><span class="number">2.0</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// layer </span></span><br><span class="line">        <span class="keyword">if</span> config.layer <span class="operator">==</span> .bottom &#123;</span><br><span class="line">          	<span class="comment">// æ­£ç‰‡å åº• è¯¦è§ï¼šhttps://www.jianshu.com/p/7c92c57cdf6f</span></span><br><span class="line">            context.setBlendMode(.multiply)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¡ç®—ç»˜åˆ¶çš„è¡Œå’Œåˆ—</span></span><br><span class="line">        <span class="keyword">let</span> rowCount <span class="operator">=</span> <span class="type">Int</span>(sqrtLength <span class="operator">/</span> (mStrW <span class="operator">+</span> horizontalSpace)) <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">let</span> columnCount <span class="operator">=</span> <span class="type">Int</span>(sqrtLength <span class="operator">/</span> (mStrH <span class="operator">+</span> verticalSpace)) <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">        <span class="comment">// æ­¤å¤„è®¡ç®—å‡ºéœ€è¦ç»˜åˆ¶æ°´å°æ–‡å­—çš„èµ·å§‹ç‚¹ï¼Œç”±äºæ°´å°åŒºåŸŸè¦å¤§äºå›¾ç‰‡åŒºåŸŸæ‰€ä»¥èµ·ç‚¹åœ¨åŸæœ‰åŸºç¡€ä¸Šç§»</span></span><br><span class="line">        <span class="keyword">let</span> orignX <span class="operator">=</span> <span class="operator">-</span>(sqrtLength <span class="operator">-</span> contextWidth) <span class="operator">/</span> <span class="number">2.0</span></span><br><span class="line">        <span class="keyword">let</span> orignY <span class="operator">=</span> <span class="operator">-</span>(sqrtLength <span class="operator">-</span> contextHeight) <span class="operator">/</span> <span class="number">2.0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> tempOrignX <span class="operator">=</span> orignX</span><br><span class="line">        <span class="keyword">var</span> tempOrignY <span class="operator">=</span> orignY</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span><span class="operator">..&lt;</span>rowCount<span class="operator">*</span>columnCount &#123;</span><br><span class="line">            <span class="comment">// æ¸²æŸ“æ–‡æœ¬</span></span><br><span class="line">            <span class="type">NSString</span>(string: config.text)</span><br><span class="line">          .draw(in: <span class="type">CGRect</span>(x: tempOrignX, y: tempOrignY, width: mStrW, height: mStrH),</span><br><span class="line">                withAttributes: attributes)</span><br><span class="line">            <span class="comment">// æ¢è¡Œ</span></span><br><span class="line">            <span class="keyword">if</span> i <span class="operator">%</span> rowCount <span class="operator">==</span> <span class="number">0</span> <span class="operator">&amp;&amp;</span> i <span class="operator">!=</span> <span class="number">0</span> &#123;</span><br><span class="line">                tempOrignX <span class="operator">=</span> orignX</span><br><span class="line">                tempOrignY <span class="operator">+=</span> (mStrH <span class="operator">+</span> verticalSpace)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                tempOrignX <span class="operator">+=</span> (mStrW <span class="operator">+</span> horizontalSpace)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        context.restoreGState()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç‰¹åˆ«éœ€è¦æ³¨æ„çš„åœ°æ–¹æœ‰2ä¸ªç‚¹ï¼š</p>
<ul>
<li>CGContextçš„åæ ‡ç³»(åŸç‚¹åœ¨å·¦ä¸‹è§’)å’ŒUIKitçš„åæ ‡ç³»(åŸç‚¹åœ¨å·¦ä¸Šè§’))ä¸ä¸€æ ·ï¼Œéœ€è¦è½¬æ¢åæ ‡ç³»ã€‚</li>
<li>å¯¼å‡ºçš„æ—¶å€™CGContextçš„åæ ‡ç³»ä¹Ÿä¸ä¸€æ ·(åŸç‚¹åœ¨å³ä¸‹è§’)ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†<code>config.textAngle - rotation</code>æ°´å°æ—‹è½¬è§’åº¦å‡å»é¡µé¢è‡ªèº«çš„æ—‹è½¬è§’åº¦</li>
</ul>
</blockquote>
</li>
<li><p>å¯¼å‡ºæ°´å°</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> PDFKit</span><br><span class="line"></span><br><span class="line"><span class="comment">/// PDFé¡µç ç®¡ç†</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PDFWatermarkTool</span>: <span class="title class_">NSObject</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> configuration: <span class="type">Configuration</span> &#123;</span><br><span class="line">        <span class="keyword">didSet</span> &#123;</span><br><span class="line">            <span class="type">PageConfiguration</span>.shared.configuration <span class="operator">=</span> configuration</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> pdfDocument: <span class="type">PDFDocument</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>(<span class="params">pdfPath</span>: <span class="type">String</span>, <span class="params">configuration</span>: <span class="type">Configuration</span> <span class="operator">=</span> <span class="type">Configuration</span>()) &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> document <span class="operator">=</span> <span class="type">PDFDocument</span>(url: <span class="type">URL</span>(fileURLWithPath: pdfPath)) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">fatalError</span>(<span class="string">&quot;è¯·ä¼ å…¥æœ‰æ•ˆçš„PDFè·¯å¾„&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">self</span>.configuration <span class="operator">=</span> configuration</span><br><span class="line">        <span class="type">PageConfiguration</span>.shared.configuration <span class="operator">=</span> configuration</span><br><span class="line">        pdfDocument <span class="operator">=</span> document</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">        pdfDocument.delegate <span class="operator">=</span> <span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">exportFile</span>(<span class="params">complate</span>: <span class="keyword">@escaping</span> (<span class="keyword">_</span> outputPath: <span class="type">String</span>?) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> newConfiguration <span class="operator">=</span> configuration</span><br><span class="line">        newConfiguration.isExport <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">        configuration <span class="operator">=</span> newConfiguration</span><br><span class="line">        </span><br><span class="line">        <span class="type">DispatchQueue</span>.global(qos: .background).async &#123;[<span class="keyword">weak</span> <span class="keyword">self</span>] <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> `self` <span class="operator">=</span> <span class="keyword">self</span> <span class="keyword">else</span> &#123;<span class="keyword">return</span>&#125;</span><br><span class="line">            <span class="keyword">var</span> path: <span class="type">String</span>?</span><br><span class="line">            path <span class="operator">=</span> <span class="type">NSTemporaryDirectory</span>() <span class="operator">+</span> <span class="string">&quot;test.pdf&quot;</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">self</span>.pdfDocument.write(toFile: path<span class="operator">!</span>) &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;å¯¼å‡ºæ–‡ä»¶æˆåŠŸ - <span class="subst">\(path<span class="operator">!</span>)</span>&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">                complate(path)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">PDFWatermarkTool</span>: <span class="title class_">PDFDocumentDelegate</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">classForPage</span>() -&gt; <span class="type">AnyClass</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">FZPDFWatermarkPage</span>.<span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">PDFWatermarkTool</span> &#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">PageConfiguration</span> &#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">let</span> shared <span class="operator">=</span> <span class="type">PageConfiguration</span>()</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> configuration: <span class="type">FZPDFWatermarkTool</span>.<span class="type">Configuration</span> <span class="operator">=</span> <span class="type">FZPDFWatermarkTool</span>.<span class="type">Configuration</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">PDFWatermarkTool</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Configuration</span> &#123;</span><br><span class="line">        <span class="comment">/// æ°´å°æ–‡å­—</span></span><br><span class="line">        <span class="keyword">var</span> text: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;ç»´æƒå¿…ç©¶&quot;</span></span><br><span class="line">        <span class="comment">/// æ–‡æœ¬é¢œè‰²</span></span><br><span class="line">        <span class="keyword">var</span> textColor: <span class="type">UIColor</span> <span class="operator">=</span> .red</span><br><span class="line">        <span class="comment">/// æ–‡æœ¬å­—ä½“</span></span><br><span class="line">        <span class="keyword">var</span> textFont: <span class="type">UIFont</span> <span class="operator">=</span> .systemFont(ofSize: <span class="number">16</span>)</span><br><span class="line">        <span class="comment">/// æ–‡å­—å‚ç›´æ–¹å‘é—´è·</span></span><br><span class="line">        <span class="keyword">var</span> textVerticalSpace: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">50.0</span></span><br><span class="line">        <span class="comment">/// æ–‡å­—æ°´å¹³æ–¹å‘é—´è·</span></span><br><span class="line">        <span class="keyword">var</span> textHorizontalSpace: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">50.0</span></span><br><span class="line">        <span class="comment">/// é€æ˜åº¦</span></span><br><span class="line">        <span class="keyword">var</span> textAlpha: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">1.0</span></span><br><span class="line">        <span class="comment">/// å€¾æ–œè§’åº¦</span></span><br><span class="line">        <span class="keyword">var</span> textAngle: <span class="type">Int</span> <span class="operator">=</span> <span class="number">45</span></span><br><span class="line">        <span class="comment">/// å›¾å±‚ é¡¶éƒ¨å’Œåº•éƒ¨</span></span><br><span class="line">        <span class="keyword">var</span> layer: <span class="type">Layer</span> <span class="operator">=</span> .bottom</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/// å¼€å§‹é¡µé¢ä½ç½®</span></span><br><span class="line">        <span class="keyword">var</span> startPageIndex: <span class="type">Int</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">        <span class="comment">/// ç»“æŸé¡µé¢ä½ç½®</span></span><br><span class="line">        <span class="keyword">var</span> endPageIndex: <span class="type">Int</span> <span class="operator">=</span> .max</span><br><span class="line">        <span class="comment">/// æ˜¯å¦æ˜¯å¯¼å‡º</span></span><br><span class="line">        <span class="keyword">var</span> isExport: <span class="type">Bool</span> <span class="operator">=</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Vertical</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> top</span><br><span class="line">        <span class="keyword">case</span> bottom</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Horizontal</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> left</span><br><span class="line">        <span class="keyword">case</span> right</span><br><span class="line">        <span class="keyword">case</span> center</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Layer</span>:<span class="title class_">Codable</span>, <span class="title class_">CaseIterable</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> top</span><br><span class="line">        <span class="keyword">case</span> bottom</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>TODO: è¿™é‡Œå¯¼å‡ºçš„æ—¶å€™ä¼šèµ°PDFPageçš„<code>func draw(with box: PDFDisplayBox, to context: CGContext)</code>æ–¹æ³•ï¼Œå¹¶ä¸”æ˜¯ä¸€é¡µä¸€é¡µçš„å»æ¸²æŸ“ï¼Œæœ€åå†å†™å…¥åˆ°æ–‡ä»¶é‡Œé¢ï¼Œç†è®ºä¸Šå¯ä»¥è·å–å¯¼å‡ºè¿›åº¦çš„ã€‚</p>
</li>
</ul>
<h3 id="é¡µé¢å±•ç¤º"><a href="#é¡µé¢å±•ç¤º" class="headerlink" title="é¡µé¢å±•ç¤º"></a>é¡µé¢å±•ç¤º</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> PDFKit</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ViewController</span>: <span class="title class_">UIViewController</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">var</span> pdfView: <span class="type">PDFView</span> <span class="operator">=</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> view <span class="operator">=</span> <span class="type">PDFView</span>(frame: <span class="keyword">self</span>.view.frame)</span><br><span class="line">        view.autoScales <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">        view.isUserInteractionEnabled <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">                view.backgroundColor <span class="operator">=</span> .main_bg_blue_color</span><br><span class="line"><span class="comment">//        view.displayMode = .twoUp</span></span><br><span class="line">        view.displayBox <span class="operator">=</span> .artBox</span><br><span class="line"><span class="comment">//        view.usePageViewController(true, withViewOptions: nil)</span></span><br><span class="line">        view.displayDirection <span class="operator">=</span> .vertical</span><br><span class="line">        view.autoScales <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">lazy</span> <span class="keyword">var</span> pdfWatermark: <span class="type">FZPDFWatermarkTool</span> <span class="operator">=</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> pdfUrl <span class="operator">=</span> <span class="type">Bundle</span>.main.url(forResource: <span class="string">&quot;ASample&quot;</span>, withExtension: <span class="string">&quot;pdf&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> config <span class="operator">=</span> <span class="type">PDFWatermarkTool</span>.<span class="type">Configuration</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> pdfWatermark <span class="operator">=</span> <span class="type">PDFWatermarkTool</span>(pdfPath: (pdfUrl<span class="operator">?</span>.path)<span class="operator">!</span>, configuration: config)</span><br><span class="line">        <span class="keyword">return</span> pdfWatermark</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidLoad</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">        pdfView.document <span class="operator">=</span> pdfWatermark.pdfDocument</span><br><span class="line"></span><br><span class="line">        view.addSubview(pdfView)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="èµ„æ–™"><a href="#èµ„æ–™" class="headerlink" title="èµ„æ–™"></a>èµ„æ–™</h3><p>å®˜æ–¹æ·»åŠ æ°´å°èµ„æ–™: <a href="https://developer.apple.com/documentation/pdfkit/custom_graphics">https://developer.apple.com/documentation/pdfkit/custom_graphics</a></p>
<p>PDFKitè‹¹æœå®˜æ–¹èµ„æ–™ï¼š<a href="https://developer.apple.com/documentation/pdfkit">https://developer.apple.com/documentation/pdfkit</a></p>
<p>Quartz 2Dï¼š<a href="https://developer.apple.com/documentation/coregraphics">https://developer.apple.com/documentation/coregraphics</a></p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>å®‰è£…hexo</title>
    <url>/2018/06/27/%E5%AE%89%E8%A3%85hexo/</url>
    <content><![CDATA[<h2 id="å‰"><a href="#å‰" class="headerlink" title="å‰"></a>å‰</h2><p>å¾ˆä¹…ä¹‹å‰å°±æƒ³å†™åšå®¢ï¼Œä¹‹å‰ä¹Ÿé€šè¿‡githubå®‰è£…è¿‡hexoã€‚ä¸è¿‡ä¹‹å‰å®‰è£…çš„æ—¶å€™æœ‰äº›é—®é¢˜ï¼Œåˆ°æ—¶åœ¨æˆ‘æ¢ç”µè„‘ä¹‹ååšå®¢å°±æ‰“ä¸å¼€äº†ï¼Œåªèƒ½é‡æ–°å®‰è£…ã€‚è¿™æ¬¡çš„hexoä¹‹æ—…è§£å†³äº†ä¹‹å‰hexoæ¢ç”µè„‘åçš„å°´å°¬ã€‚åœ¨å†™è¿™ç¯‡åšå®¢ä¹‹å‰å¾ˆæ„Ÿè°¢<a href="https://www.zhihu.com/question/21193762/answer/79109280">çŸ¥ä¹å¤§ç¥</a>æä¾›çš„æ–¹æ¡ˆã€‚</p>
<hr>
<h2 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h2><h3 id="åšå®¢æ­å»º"><a href="#åšå®¢æ­å»º" class="headerlink" title="åšå®¢æ­å»º"></a>åšå®¢æ­å»º</h3><blockquote>
<p>ä¸»è¦çš„è®¾è®¡æ€è·¯å°±æ˜¯ï¼Œåœ¨githubçš„ä»“åº“ä¸Šåˆ›å»ºä¸¤ä¸ªåˆ†æ”¯</p>
<ul>
<li>blog ç”¨æ¥å­˜æ”¾hexoçš„é™æ€ç½‘é¡µï¼ˆç›¸å½“äºåå°ï¼‰</li>
<li>master ç”¨æ¥å­˜æ”¾hexoç¼–è¯‘ç”Ÿæˆçš„ç½‘ç«™æ–‡ä»¶ï¼ˆç›¸å½“äºå‰ç«¯ï¼‰</li>
</ul>
</blockquote>
<ul>
<li>åœ¨githubä¸Šåˆ›å»ºä»“åº“ï¼Œå–åä¸º xxx.github.io(xxxä¸ºä½ çš„githubåç§°);</li>
<li>é€šè¿‡sourceTreeæŠŠgithubä¸Šçš„ä»“åº“cloneåˆ°æœ¬åœ°ï¼›</li>
<li>åˆ›å»ºä¸€ä¸ªåˆ†æ”¯blogï¼Œé»˜è®¤æœ‰ä¸€ä¸ªmaster</li>
<li>åœ¨æœ¬åœ°ä»“åº“åœ°å€çš„æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªç©ºç›®å½•ï¼Œå–åhexoï¼ˆè¿™ä¸ªå°±æ˜¯ä»¥ååšå®¢çš„æ ¹ç›®å½•ï¼‰</li>
<li>é€šè¿‡ç»ˆç«¯cdåˆ°åˆšåˆšåˆ›å»ºçš„ç›®å½•ä¸‹ï¼Œä¾æ¬¡æ‰§è¡Œ  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å®‰è£…hexo</span><br><span class="line">npm install hexo</span><br><span class="line">//åˆå§‹åŒ–hexo</span><br><span class="line">hexo init</span><br><span class="line">//å®‰è£…ä¸githubçš„æ¡¥æ¥æ–‡ä»¶</span><br><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure></li>
<li>ä¿®æ”¹_config.ymlä¸­çš„deployå‚æ•°ï¼Œä¾‹å¦‚ï¼š  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">    type: git</span><br><span class="line">    repository: https://github.com/xxx/xxx.github.io.git #è®°å¾—æŠŠxxxæ›¿æ¢æˆä½ çš„githubåå­—</span><br><span class="line">    branch: master</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™æ ·å°±è¡¨ç¤ºä½ é€šè¿‡ hexo g -d éƒ¨ç½²ç”Ÿæˆçš„æ–‡ä»¶ä¼šç›´è‡ªåŠ¨åŒæ­¥åˆ°ä½ çš„masteråˆ†æ”¯ä¸Šå»</p>
</blockquote>
</li>
<li>åœ¨blogåˆ†æ”¯ä¸‹æŠŠæ”¹åŠ¨çš„å†…å®¹æ¨é€åˆ°githubä¸Šå»</li>
<li>æ‰§è¡Œ hexo g -d ç”Ÿæˆç½‘ç«™å¹¶ä¸”éƒ¨ç½²åˆ°githubä¸Š  </li>
<li>over</li>
</ul>
<h3 id="æ—¥å¸¸æ“ä½œ"><a href="#æ—¥å¸¸æ“ä½œ" class="headerlink" title="æ—¥å¸¸æ“ä½œ"></a>æ—¥å¸¸æ“ä½œ</h3><ul>
<li>åœ¨æœ¬åœ°ä¿®æ”¹ä¹‹åï¼Œæ¨é€åˆ°githubä¸Š</li>
<li>åœ¨ç»ˆç«¯æ‰§è¡Œ hexo g -d é‡æ–°éƒ¨ç½² åˆ°masteråˆ†æ”¯ä¸Š</li>
</ul>
<h3 id="æ›´æ¢ç”µè„‘"><a href="#æ›´æ¢ç”µè„‘" class="headerlink" title="æ›´æ¢ç”µè„‘"></a>æ›´æ¢ç”µè„‘</h3><ul>
<li>ä»githubä¸Šcloneä¸‹blogåˆ†æ”¯</li>
<li>åœ¨æœ¬åœ°hexoï¼ˆåšå®¢æ ¹æ–‡ä»¶å¤¹ï¼‰æ–‡ä»¶å¤¹ä¸‹é€šè¿‡ç»ˆç«¯ä¾æ¬¡æ‰§è¡Œï¼š  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å®‰è£…hexo</span><br><span class="line">npm install hexo</span><br><span class="line">//å®‰è£…ä¸githubçš„æ¡¥æ¥æ–‡ä»¶</span><br><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ï¼šä¸éœ€è¦hexo init </p>
<p>å¦‚æœä½ å®‰è£…äº†ä¸»é¢˜ï¼Œé‚£ä¹ˆä½ éœ€è¦é‡æ–°åœ¨åšå®¢æ ¹æ–‡ä»¶å¤¹ä¸‹å®‰è£…ä¸»é¢˜ã€‚</p>
</blockquote>
</li>
</ul>
<h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»æ­å»ºäº†ä¸€ä¸ªå®Œç¾çš„å¯ä»¥ç§»æ¤çš„hexoåšå®¢äº†ï¼Œå½“ç„¶é¡µé¢å¾ˆä¸‘ã€‚</p>
<blockquote>
<p>å¯ä»¥é€šè¿‡<a href="https://hexo.io/themes/">hexoä¸»é¢˜</a>æ¥é€‰æ‹©ä¸€ä¸ªæ¼‚äº®çš„ä¸»é¢˜ï¼ˆå½“ç„¶ä¸»é¢˜é…ç½®ä¹Ÿä¼šæœ‰å¾ˆå¤šå‘ï¼‰</p>
</blockquote>
<blockquote>
<p>æ¨èä¸»é¢˜ï¼š</p>
</blockquote>
<ul>
<li><a href="https://github.com/theme-next/hexo-theme-next">NexTæ˜¯exoä¼˜é›…è€Œå¼ºå¤§çš„ä¸»é¢˜</a></li>
<li><a href="https://github.com/Molunerfinn/hexo-theme-melody">exoçš„ä¸€ä¸ªç®€å•ï¼†ç¾ä¸½ï¼†å¿«é€Ÿçš„ä¸»é¢˜</a>(æˆ‘ç›®å‰ä½¿ç”¨çš„ä¸»é¢˜)</li>
</ul>
<p>åªæ˜¯æˆ‘åœ¨æ­å»ºå¥½ä¸ªäººåšå®¢ä¹‹åå†™çš„ç¬¬ä¸€ç¯‡åšå®¢ï¼Œæœ‰å¾ˆå¤šåœ°æ–¹å†™å¾—ä¸ä¼˜é›…ï¼Œå¸Œæœ›å¤§å®¶å¤šæµ·æ¶µã€‚</p>
<p>åœ¨ä»¥åçš„æ—¥å­é‡Œæˆ‘ä¼šç»å¸¸æ›´æ–°åšå®¢çš„ã€‚</p>
<blockquote>
<p>åƒé‡Œä¹‹è¡Œå§‹äºè¶³ä¸‹</p>
</blockquote>
]]></content>
      <categories>
        <category>æ–°é²œäº‹ç‰©</category>
      </categories>
      <tags>
        <tag>éšè®°</tag>
      </tags>
  </entry>
  <entry>
    <title>è¿æ¥mysql</title>
    <url>/2018/07/12/%E8%BF%9E%E6%8E%A5mysql/</url>
    <content><![CDATA[<p>æœ€è¿‘åœ¨å­¦ä¹ springbootï¼Œåˆšåˆšå­¦åˆ°äº†è¿æ¥æ•°æ®åº“è¿™é‡Œã€‚ä½œä¸ºå°ç™½çš„æˆ‘é‡è§ä¸€ä¸ªå¥‡æ€ªçš„é”™è¯¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">### Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure</span><br></pre></td></tr></table></figure>
<p>é…ç½®ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/test1?useSSL=true</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=123456</span><br><span class="line">spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åŸæ¥æ˜¯å¼€å¯äº†sslåŠ å¯†è¿æ¥æ–¹å¼ã€‚ä½†æ˜¯åˆæ²¡æœ‰é…ç½®sslåŠ å¯†ï¼Œæ‰€ä»¥å¯¼è‡´ä¸èƒ½è¿æ¥ä¸Šæ•°æ®åº“ã€‚<br>mysqlé«˜ç‰ˆæœ¬éƒ½æ¨èä½¿ç”¨sslçš„æ–¹å¼è¿æ¥æ•°æ®åº“ã€‚<br><a href="https://dev.mysql.com/doc/refman/5.7/en/using-encrypted-connections.html#using-encrypted-connections-server-side-configuration">é…ç½®æ–¹æ³•</a></p>
</blockquote>
<blockquote>
<p>ä¸è¿‡ä¸éœ€è¦ä½¿ç”¨sslè¿™ç§è¿æ¥æ–¹å¼çš„è¯å¯ä»¥ä½¿ç”¨useSSL&#x3D;falseé¿å…è¿™ä¸ªé”™è¯¯ ï¼Œæˆ–è€…ä½¿ç”¨verifyServerCertificate&#x3D;falseä¸ä½¿ç”¨è¯ä¹¦é…ç½®</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/test1?useSSL=true&amp;verifyServerCertificate=false</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>SpringBoot</category>
      </categories>
      <tags>
        <tag>éšè®°</tag>
      </tags>
  </entry>
</search>
